<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/x-icon" href="%PUBLIC_URL%/favicon.ico" />
    <link rel="icon" type="image/png" href="%PUBLIC_URL%/youredu-cap.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="YourEDU - Design Your Own Education Journey" />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/youredu-cap.png" />

    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:title" content="YourEDU" />
    <meta property="og:description" content="Empowering families to design personalized homeschool education journeys" />
    <meta property="og:image" content="%PUBLIC_URL%/youredu-cap.png" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="512" />
    <meta property="og:image:height" content="512" />
    <meta property="og:url" content="%PUBLIC_URL%" />
    <meta property="og:type" content="website" />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="YourEDU" />
    <meta name="twitter:description" content="Empowering families to design personalized homeschool education journeys" />
    <meta name="twitter:image" content="%PUBLIC_URL%/youredu-cap.png" />

    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <title>YourEDU</title>

    <!-- PostHog - Primary Initialization (Official Snippet) -->
    <script>
      !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init capture register register_once register_for_session unregister unregister_for_session getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey getNextSurveyStep identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty createPersonProfile opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing debug getPageViewId captureTraceFeedback captureTraceMetric".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
      
      // Only initialize in production environments
      const hostname = window.location.hostname;
      const isProduction = hostname === 'app.youredu.school' || hostname.endsWith('youredu.school') || hostname.includes('vercel.app');
      
      if (isProduction) {
        // Initialize PostHog with the official configuration
        posthog.init('phc_siJIQFcoAOCjoSVKMoLjLI5Qoz0xSJ08AZrwUXF4Iko', {
          api_host: 'https://us.i.posthog.com',
          // Enable session recording by default
          disable_session_recording: false,
          session_recording: {
            enabled: true,
            maskAllInputs: false,
            maskInputOptions: {
              password: true,
              creditCard: true
            },
            recordCanvas: true
          },
          // Standard configuration
          capture_pageview: true,
          autocapture: true,
          capture_pageleave: true,
          persistence: 'localStorage+cookie',
          persistence_name: '_ph_youredu',
          cross_subdomain_cookie: true,
          secure_cookie: true,
          respect_dnt: false,
          // Always create person profiles for better user tracking
          person_profiles: 'always',
          // Improve cookie persistence
          cookie_secure: true,
          cookie_expiration: 365, // 1 year in days
          loaded: function(posthog) {
            console.log('[PostHog] Successfully initialized from HTML snippet');
            
            // Log session recording status
            if (typeof posthog.get_session_recording_enabled === 'function') {
              const isRecording = posthog.get_session_recording_enabled();
              console.log(`[PostHog] Session recording status: ${isRecording ? 'Active' : 'Inactive'}`);
              
              // Start recording if not already active
              if (!isRecording && typeof posthog.startSessionRecording === 'function') {
                posthog.startSessionRecording();
                console.log('[PostHog] Session recording started from HTML snippet');
              }
            }
            
            // Set a flag to indicate PostHog is ready for identification
            window.posthogInitialized = true;
            // Dispatch an event that our JS can listen for
            window.dispatchEvent(new Event('posthog_initialized'));
          }
        });
      } else {
        console.log('[PostHog] Development environment detected, not initializing');
        
        // Create stub functions for development
        window.posthog = window.posthog || {
          capture: function() {},
          identify: function() {},
          reset: function() {},
          people: { set: function() {} },
          register: function() {},
          unregister: function() {},
          opt_in_capturing: function() {},
          opt_out_capturing: function() {},
          has_opted_out_capturing: function() { return false; },
          has_opted_in_capturing: function() { return true; },
          get_distinct_id: function() { return 'placeholder_id'; },
          get_session_id: function() { return null; },
          isFeatureEnabled: function() { return false; },
          getFeatureFlag: function() { return null; },
          reloadFeatureFlags: function() {},
          onFeatureFlags: function() {},
          startSessionRecording: function() {},
          stopSessionRecording: function() {},
          get_session_recording_enabled: function() { return false; },
          get_session_replay_url: function() { return null; },
          setPersonProperties: function() {},
          _loaded: false
        };
        
        // Set initialization flag for development
        window.posthogInitialized = true;
        window.dispatchEvent(new Event('posthog_initialized'));
      }
    </script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
</html>
